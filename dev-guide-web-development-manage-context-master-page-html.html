<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html xmlns:innovasys="" xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <meta name="ResourceType" content="Documentation" /><meta name="ParentProductId" content="638" /><meta name="ProductId" content="638" /> 
    <title>Using a Master Page</title>
    <link href="stylesheets/helpstudio.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="stylesheets/customstyles.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="Stylesheets/hs-expandcollapse.css"></link>

    <script src="script/helpstudio.js" type="text/javascript">
</script><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>

</head>

<body id="hsbody">
    

    <div style="DISPLAY: none">
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset">
    </div><img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/collapse.gif" name="collapseImage"> <img id="expandImage" style=
    "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/expand.gif" name="expandImage"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
    src="images/copycode.gif" name="copyImage"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/copycodeHighlight.gif"
    name="copyHoverImage">

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">Telerik OpenAccess ORM</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:documentation@telerik.com?subject=Documentation Feedback:Telerik OpenAccess ORM-dev-guide-web-development-manage-context-master-page">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">Using a Master Page</span></td>
                </tr>
                
			</tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
Programmer's Guide > Developer's Guide > <a href="developer-guide-aspnet-dev-asp-overview.html">ASP.NET Development</a> > <a href="dev-guide-web-development-manage-context-overview.html">Managing the OpenAccessContext in Web Applications</a> > Using a Master Page</td></tr></table>
    </div>

    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>

    <div id="pagebody">
        <div id="mainbody">
            <P>In this topic you will learn how to manage the OpenAccessContext in the <STRONG>MasterPage</STRONG>.&nbsp;</P>
<P>Suppose, you have an ASP.NET Web Application and Telerik OpenAccess Domain Model.</P>
<P><IMG border=0 alt="" src="images/1DevGuide-WebDevelopment-ManageContext-MasterPage-010.png"></P>
<OL>
<LI>Open the <STRONG>Master Page</STRONG> for your web application (in this demo this is <STRONG>Site.Master</STRONG>). 
<LI>In the code-behind file of that page, create a field for the <STRONG>OpenAccessContext</STRONG> and then create a public property, so the context could be accessed from the pages that have this page as a master. 
<LI>Override the <STRONG>OnInit</STRONG> method. Here you need to initialize the context, i.e. to create a new instance of the OpenAccessContext. 
<LI>The final step is to dispose the context. You need to override the <STRONG>Dispose</STRONG> method and dispose the context there.</LI></OL>
<DIV id=Syntax_CS class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>C#</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedcode><FONT color=blue>using</FONT> <FONT color=black>System;<BR></FONT><FONT color=blue>namespace</FONT> <FONT color=black>BestPracticesMasterPage<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>public</FONT> <FONT color=black>partial</FONT> <FONT color=blue>class</FONT> <FONT color=black>SiteMaster : System.Web.UI.MasterPage<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>private</FONT> <FONT color=black>EntitiesModel context;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>public</FONT> <FONT color=black>EntitiesModel ModelContext<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get {</FONT> <FONT color=blue>return</FONT> <FONT color=blue>this</FONT><FONT color=black>.context; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set {</FONT> <FONT color=blue>this</FONT><FONT color=black>.context = value; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>protected</FONT> <FONT color=blue>override</FONT> <FONT color=blue>void</FONT> <FONT color=black>OnInit(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>base</FONT><FONT color=black>.OnInit(e);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>this</FONT><FONT color=black>.context =</FONT> <FONT color=blue>new</FONT> <FONT color=black>EntitiesModel();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>public</FONT> <FONT color=blue>override</FONT> <FONT color=blue>void</FONT> <FONT color=black>Dispose()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=green>//The disposal of the scope is made here, just before the Page is disposed<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=green>//When using multiple pages the best way is to do this step in the Dispose()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=green>//method of the Master Page as well<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>this</FONT><FONT color=black>.context.Dispose();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>base</FONT><FONT color=black>.Dispose();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=Syntax_VB.NET class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>VB.NET</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedvbcode><FONT class=keyword>Public</FONT> <FONT class=keyword>Class</FONT> Site<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Inherits</FONT> System.Web.UI.MasterPage<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Private</FONT> _context <FONT class=keyword>As</FONT> EntitiesModel<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Public</FONT> <FONT class=keyword>Property</FONT> ModelContext() <FONT class=keyword>As</FONT> EntitiesModel<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Get</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Return</FONT> <FONT class=keyword>Me</FONT>._context<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Get</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Set</FONT>(<FONT class=keyword>ByVal</FONT> value <FONT class=keyword>As</FONT> EntitiesModel)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Me</FONT>._context = value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Set</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Property</FONT><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Protected</FONT> <FONT class=keyword>Overrides</FONT> <FONT class=keyword>Sub</FONT> OnInit(<FONT class=keyword>ByVal</FONT> e <FONT class=keyword>As</FONT> EventArgs)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>MyBase</FONT>.OnInit(e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Me</FONT>._context = <FONT class=keyword>New</FONT> EntitiesModel()<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Sub</FONT><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Public</FONT> <FONT class=keyword>Overrides</FONT> <FONT class=keyword>Sub</FONT> Dispose()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=comment>'The disposal of the scope is made here, just before the Page is disposed</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=comment>'When using multiple pages the best way is to do this step in the Dispose()</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=comment>'method of the Master Page as well</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Me</FONT>._context.Dispose()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>MyBase</FONT>.Dispose()<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Sub</FONT><BR><FONT class=keyword>End</FONT> <FONT class=keyword>Class</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<H1>Accessing the OpenAccessContext from the Pages</H1>
<P>For every page that will use the <STRONG>OpenAccessContext</STRONG>, you should declare a field that exposes the context. You need to override the <STRONG>OnInit</STRONG> method and there you will initialize (retrieve) the context. Next in the <STRONG>Page_Load</STRONG> method you could load the required data by using the already retrieved context. The code-snippet below shows how the Default.aspx page could look like:</P>
<DIV id=Syntax_CS class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>C#</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedcode><FONT color=blue>using</FONT> <FONT color=black>System;<BR></FONT><FONT color=blue>using</FONT> <FONT color=black>System.Collections.Generic;<BR></FONT><FONT color=blue>using</FONT> <FONT color=black>System.Linq;<BR><BR></FONT><FONT color=blue>namespace</FONT> <FONT color=black>BestPracticesMasterPage<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>public</FONT> <FONT color=black>partial</FONT> <FONT color=blue>class</FONT> <FONT color=black>_Default : System.Web.UI.Page<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>private</FONT> <FONT color=black>EntitiesModel dbContext;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>protected</FONT> <FONT color=blue>override</FONT> <FONT color=blue>void</FONT> <FONT color=black>OnInit(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>base</FONT><FONT color=black>.OnInit(e);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SiteMaster siteMaster =</FONT> <FONT color=blue>this</FONT><FONT color=black>.Master</FONT> <FONT color=blue>as</FONT> <FONT color=black>SiteMaster;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>this</FONT><FONT color=black>.dbContext = siteMaster.ModelContext;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=blue>protected</FONT> <FONT color=blue>void</FONT> <FONT color=black>Page_Load(</FONT><FONT color=blue>object</FONT> <FONT color=black>sender, EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=green>// Load your data here.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=black>List&lt;Category&gt; categories =</FONT> <FONT color=blue>this</FONT><FONT color=black>.dbContext.Categories.ToList();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=Syntax_VB.NET class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>VB.NET</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedvbcode><FONT class=keyword>Public</FONT> <FONT class=keyword>Class</FONT> _Default<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Inherits</FONT> System.Web.UI.Page<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Private</FONT> dbContext <FONT class=keyword>As</FONT> EntitiesModel<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Protected</FONT> <FONT class=keyword>Overrides</FONT> <FONT class=keyword>Sub</FONT> OnInit(<FONT class=keyword>ByVal</FONT> e <FONT class=keyword>As</FONT> EventArgs)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>MyBase</FONT>.OnInit(e)<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Dim</FONT> _siteMaster <FONT class=keyword>As</FONT> Site = TryCast(<FONT class=keyword>Me</FONT>.Master, Site)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Me</FONT>.dbContext = _siteMaster.ModelContext<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Sub</FONT><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Protected</FONT> <FONT class=keyword>Sub</FONT> Page_Load(<FONT class=keyword>ByVal</FONT> sender <FONT class=keyword>As</FONT> <FONT class=keyword>Object</FONT>, <FONT class=keyword>ByVal</FONT> e <FONT class=keyword>As</FONT> EventArgs)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=comment>' Load your data here.</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>Dim</FONT> categories <FONT class=keyword>As</FONT> List(Of Category) = <FONT class=keyword>Me</FONT>.dbContext.Categories.ToList()<BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT class=keyword>End</FONT> <FONT class=keyword>Sub</FONT><BR><FONT class=keyword>End</FONT> <FONT class=keyword>Class</FONT></DIV></TD></TR></TBODY></TABLE></DIV> <a id="seealsobookmark" name="seealsobookmark"></a>
            
        </div>

        <div id="pagefooter">
            <p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p>&copy; 2002-2012 Telerik. All Rights Reserved.</p>
        </div>
    </div>
</body>
</html>